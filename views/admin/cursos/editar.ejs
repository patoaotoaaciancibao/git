<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Editar Curso</title>
  <%- include('../../partials/head') %>
</head>
<body>
<style>
  .alert-auto {
    font-size: 0.9rem;
    max-width: 500px;
    margin: 0 auto 20px;
    padding: 10px 16px;
    opacity: 1;
    transition: opacity 0.5s ease, transform 0.5s ease;
    z-index: 999;
    position: relative;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .alert-auto.fade-out {
    opacity: 0;
    transform: translateY(-10px);
  }
</style>

<%- include('../../partials/navbar') %>

<div class="container py-5">
  <h1 class="text-center mb-4">Editar Curso</h1>
  
  <% if (msg === 'actualizado') { %>
    <div class="alert alert-success alert-dismissible fade show alert-auto" role="alert">
      <i class="fas fa-check-circle me-2"></i> El curso se actualizó correctamente.
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
    </div>
  <% } %>

  <div class="card shadow p-4 mx-auto" style="max-width: 600px;">
    <form action="/admin/cursos/<%= curso.id_curso %>/editar" method="POST" enctype="multipart/form-data">
      <div class="mb-3">
        <label for="nombre" class="form-label">Nombre del Curso</label>
        <input type="text" class="form-control" id="nombre" name="nombre" value="<%= curso.nombre %>" required>
      </div>

      <div class="mb-3">
        <label for="descripcion" class="form-label">Descripción</label>
        <textarea class="form-control" id="descripcion" name="descripcion" rows="4" required><%= curso.descripcion %></textarea>
      </div>

      <input type="hidden" name="imagen_actual" value="<%= curso.imagen %>">

      <div class="mb-3">
        <label class="form-label">Imagen Actual</label><br>
        <% if (curso.imagen) { %>
          <img src="/cursos/<%= curso.imagen %>" alt="Imagen actual del curso" class="img-fluid rounded mb-2" style="max-height: 200px;">
        <% } else { %>
          <img src="/cursos/default.png" alt="Imagen genérica" class="img-fluid rounded mb-2" style="max-height: 200px;">
        <% } %>
      </div>

      <div class="mb-3">
        <label for="imagen" class="form-label">Reemplazar Imagen (JPG, PNG, WEBP)</label>
        <input class="form-control" type="file" id="imagen" name="imagen" accept="image/*">
      </div>

      <!-- Campo de Publicación -->
      <div class="mb-3 form-check">
        <input type="checkbox" name="publicado" class="form-check-input" id="publicado" <%= curso.publicado ? 'checked' : '' %>>
        <label class="form-check-label" for="publicado">Publicar curso</label>
      </div>

      <div class="d-flex justify-content-between">
        <a href="/admin/cursos" class="btn btn-secondary">
          <i class="fas fa-arrow-left"></i> Cancelar
        </a>
        <button type="submit" class="btn btn-success">
          <i class="fas fa-save"></i> Guardar Cambios
        </button>
      </div>
    </form>
    <div class="text-center mt-4">
      <a href="/admin/cursos" class="btn btn-secondary btn-lg shadow-sm">
        <i class="fas fa-arrow-left me-1"></i> Listado de cursos
      </a>
    </div>
  </div> <!-- ← card -->
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const alertAuto = document.querySelector('.alert-auto');
    if (alertAuto) {
      setTimeout(() => {
        alertAuto.classList.add('fade-out');
        setTimeout(() => alertAuto.remove(), 500);
      }, 5000);
    }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/assets/js/main.js"></script>

<%- include('../../partials/footer') %>
</body>
</html>
