<nav class="navbar navbar-expand-lg bg-white navbar-light shadow sticky-top p-0">
    <a href="/public/home" class="navbar-brand d-flex align-items-center ps-1">
        <img src="/img/freaks4.png" alt="Freak's Logo" width="190" height="125" class="me-2 logo-freaks">
        <h2 class="m-0 fw-bold" style="font-family: 'Nunito', sans-serif; color: purple;">FREAK's</h2>
    </a>
    <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarCollapse">
        <div class="navbar-nav ms-auto p-5 p-lg-0">
            <a href="/public/home" class="nav-item nav-link active">Home</a>
            <a class="nav-link" href="/cursos">
                <i class="fas fa-book me-2"></i> Cursos
            </a>
            <a class="nav-link" href="/profesores">
                <i class="fas fa-chalkboard-teacher me-2"></i> Profesores
            </a>
            <a class="nav-link" href="/team">
                <i class="fas fa-users me-2"></i> Equipo
            </a>
            <a class="nav-link" href="/contacto">
                <i class="fas fa-envelope-open-text me-2"></i> Contacto
            </a>

            <!-- =================================================================== -->
            <!-- LÓGICA DE SESIÓN Y PERFIL ACTUALIZADA -->
            <!-- =================================================================== -->
            <% if (usuario) { %>
                <!-- SI EL USUARIO ESTÁ LOGUEADO, MUESTRA EL MENÚ DESPLEGABLE -->
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown">
                        <img src="/profile/<%= usuario.foto_perfil || 'default-avatar.png' %>" alt="Foto de Perfil" width="32" height="32" class="rounded-circle me-2" style="object-fit: cover;">
                        <%= usuario.nombre %>
                    </a>
                    <div class="dropdown-menu fade-down m-0">
                        <a href="/auth/perfil" class="dropdown-item">
                            <i class="fas fa-user-circle me-2"></i> Mi Perfil
                        </a>

                        <li><a class="dropdown-item" href="/auth/mis-datos">Mis Datos Personales</a></li>

                        <a href="/auth/mis-cursos" class="dropdown-item">
                            <i class="fas fa-graduation-cap me-2"></i> Mis Cursos
                        </a>
                        
                        <% if (usuario.rol !== 'admin') { %>
                            <a class="dropdown-item" href="/auth/cambiar-contrasena">
                               <i class="fas fa-key me-2"></i> Cambiar contraseña
                            </a>
                            <a class="dropdown-item text-danger" href="/auth/dar-de-baja">
                                <i class="fas fa-user-slash me-2"></i> Dar de baja
                            </a>
                        <% } %>
                        
                        <hr class="dropdown-divider">
                        
                        <a href="/auth/logout" class="dropdown-item">
                            <i class="fas fa-sign-out-alt me-2"></i> Cerrar Sesión
                        </a>
                    </div>
                </div>

            <% } else { %>
                <!-- SI NO HAY USUARIO, MUESTRA INICIO DE SESIÓN Y REGISTRO -->
                <a href="/acceso" class="nav-item nav-link">
                    <i class="fas fa-sign-in-alt me-2"></i> Inicia Sesión
                </a>
                <a class="nav-item nav-link" href="/registro">Registrarse</a>
            <% } %>
            <!-- =================================================================== -->
            <!-- FIN DE LA LÓGICA DE SESIÓN -->
            <!-- =================================================================== -->

        </div>

        <a href="/registro" class="btn btn-primary py-4 px-lg-3 d-none d-lg-block">
            Únete Ahora <i class="fa fa-arrow-right ms-3"></i>
        </a>
    </div>
</nav>
