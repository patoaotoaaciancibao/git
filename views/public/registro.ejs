<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro de Usuario</title>
    <%- include('../partials/head') %>
</head>
<body>
<%- include('../partials/navbar') %>

<div class="container mt-5" style="max-width: 600px;">
    <h2 class="text-center mb-4">游닇 Crear una cuenta</h2>

    <form action="/registro/guardar" method="POST" class="border p-4 shadow rounded-4 bg-white">

        <div class="form-floating mb-3">
            <input type="text" class="form-control rounded-3 <%= error?.includes('nombre') ? 'is-invalid' : '' %>" id="nombre" name="nombre" placeholder="Nombre" required value="<%= datos?.nombre || '' %>">
            <label for="nombre">Nombre</label>
            <% if (error?.includes('nombre')) { %>
                <div class="invalid-feedback">El nombre es obligatorio.</div>
            <% } %>
        </div>

        <div class="form-floating mb-3">
            <input type="text" class="form-control rounded-3 <%= error?.includes('apellido') ? 'is-invalid' : '' %>" id="apellido" name="apellido" placeholder="Apellido" required value="<%= datos?.apellido || '' %>">
            <label for="apellido">Apellido</label>
            <% if (error?.includes('apellido')) { %>
                <div class="invalid-feedback">El apellido es obligatorio.</div>
            <% } %>
        </div>

        <div class="form-floating mb-3">
            <input type="email" class="form-control rounded-3 <%= error?.includes('correo') || error?.includes('email') ? 'is-invalid' : '' %>" id="email" name="email" placeholder="Correo electr칩nico" required value="<%= datos?.email || '' %>">
            <label for="email">Correo electr칩nico</label>
            <% if (error?.includes('inv치lido')) { %>
                <div class="invalid-feedback">Formato de correo inv치lido.</div>
            <% } else if (error?.includes('usuario con ese correo')) { %>
                <div class="invalid-feedback">Este correo ya est치 registrado.</div>
            <% } %>
        </div>

        <div class="form-floating mb-3">
            <input type="password" class="form-control rounded-3 <%= error?.includes('contrase침a') ? 'is-invalid' : '' %>" id="password" name="password" placeholder="Contrase침a" required>
            <label for="password">Contrase침a</label>
            <% if (error?.includes('al menos 6')) { %>
                <div class="invalid-feedback">Debe tener al menos 6 caracteres.</div>
            <% } %>
        </div>

        <div class="form-floating mb-4">
            <input type="password" class="form-control rounded-3 <%= error?.includes('no coinciden') ? 'is-invalid' : '' %>" id="confirmar" name="confirmar" placeholder="Repetir Contrase침a" required>
            <label for="confirmar">Repetir Contrase침a</label>
            <% if (error?.includes('no coinciden')) { %>
                <div class="invalid-feedback">Las contrase침as no coinciden.</div>
            <% } %>
        </div>

        <button type="submit" class="btn btn-primary w-100 rounded-3">Registrarme</button>
    </form>


    <div class="position-fixed top-0 end-0 p-3" style="z-index: 1050; margin-top: 70px;">
        <% if (error) { %>
            <div class="toast align-items-center text-white bg-danger border-0 show shadow" role="alert">
                <div class="d-flex">
                    <div class="toast-body">
                        <i class="fas fa-exclamation-circle me-2"></i> <%= error %>
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            </div>
        <% } %>

        <% if (success) { %>
            <div class="toast align-items-center text-white bg-success border-0 show shadow" role="alert">
                <div class="d-flex">
                    <div class="toast-body">
                        <i class="fas fa-check-circle me-2"></i> <%= success %>
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            </div>
        <% } %>
    </div>
</div>

<%- include('../partials/footer') %>

<!-- Scripts -->
<script>
    setTimeout(() => {
        document.querySelectorAll('.toast').forEach(t => {
            const toast = new bootstrap.Toast(t);
            toast.hide();
        });
    }, 5000);
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
